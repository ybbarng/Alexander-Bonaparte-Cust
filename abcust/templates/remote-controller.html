<!DOCTYPE html>
<html lang="ko">
    <head>
        <title>못생긴 리모컨</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="utf-8">
        <!-- Favicons are generated with [RealFaviconGenerator](https://realfavicongenerator.net/) [v0.16](https://realfavicongenerator.net/change_log#v0.16) -->
        <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='remote-controller/favicon/apple-touch-icon.png') }}">
        <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='remote-controller/favicon/favicon-32x32.png') }}">
        <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='remote-controller/favicon/favicon-16x16.png') }}">
        <link rel="manifest" href="{{ url_for('static', filename='remote-controller/favicon/site.webmanifest') }}">
        <link rel="mask-icon" href="{{ url_for('static', filename='remote-controller/favicon/safari-pinned-tab.svg') }}" color="#5bbad5">
        <meta name="apple-mobile-web-app-title" content="못생긴 리모컨">
        <meta name="application-name" content="못생긴 리모컨">
        <meta name="msapplication-config" content="{{ url_for('static', filename='remote-controller/favicon/browserconfig.xml') }}" />
        <meta name="msapplication-TileColor" content="#5bbad5">
        <meta name="theme-color" content="#5bbad5">
        <link rel="stylesheet" href="{{ url_for('static', filename='bounceball.css') }}" />
        <style>
        body {
            width: 420px;
            margin: auto;
            font-family: sans-serif;
        }
        header {
            text-align: center;
        }
        #remocon {
            width: 300px;
            margin: 20px auto;
            box-sizing: border-box;
            border: 1px solid #eee;
            padding: 0 30px;
            padding-bottom: 10px;
        }
        #remocon h3 {
            margin-bottom: 5px;
        }
        #remocon .icon {
            height: 23px;
            vertical-align: middle;
            margin-left: 10px;
        }

        #remocon .icon.awair {
            height: 19px;
            padding: 2px;
        }
        #cathy-loading {
            font-size: 15px;
            text-align: center;
            padding: 8px 0;
        }
        #cathy-data {
            display: none;
        }
        .data {
            padding: 2px;
        }
        .data label {
            font-size: 10px;
            text-align: center;
        }
        .data .number {
            font-weight: bold;
        }
        .color0 {
            color: #2EB886;
        }
        .color1 {
            color: #ABA74D;
        }
        .color2 {
            color: #DAA038;
        }
        .color3 {
            color: #BF511C;
        }
        .color4 {
            color: #A30200;
        }
        .unit {
            padding-left: 3px;
        }
        .data.major {
            flex-grow: 1;
        }
        .data.major .value .number {
            font-size: 25px;
        }
        .data.minor .value {
            text-align: center;
        }
        .data.minor .value .number {
            font-size: 15px;
        }
        .data .value .unit {
            font-size: 10px;
        }
        .data-head-wrapper {
            display: flex;
            align-content: stretch;
        }
        #legend {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .data-body-wrapper {
            display: flex;
            align-content: stretch;
        }
        .data.minor {
            width: 59px;
        }
        .button-group {
            display: flex;
            flex-direction: row-reverse;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }
        #footnote {
            display: flex;
            flex-direction: row-reverse;
            justify-content: center;
            align-items: center;
            margin: auto;
            margin-top: 20px;
        }
        figure {
            margin: 0;
        }
        #abc {
            width: 150px;
            height: 150px;
            flex-shrink: 0;
        }
        #abc_name {
            font-size: 12px;
            text-align: center;
        }
        #abc_script {
            position: relative;
            margin-right: 30px;
            margin-left: 30px;
            text-align: justify;
        }
        .quote {
            font-size: 70px;
            line-height: 70px;
            height: 70px;
        }
        .quote.open {
            position:absolute;
            top: -10px;
            left:-30px;
        }
        .quote.close {
            position:absolute;
            bottom: -65px;
            right: -30px;
        }
        #footer {
            margin-top: 150px;
            text-align: center;
            font-size: 13px;
        }
        @media screen and (max-width: 480px) {
            body {
                width: 100%;
            }
            #abc {
                width: 100px;
                height: 100px;
            }
        }
        </style>
    </head>
    <body>
        <div id="remocon">
            <header>
                <h2>못생긴 리모컨</h2>
            </header>
            <h3>Audrey<img class="icon" alt="에어컨" src="{{ url_for('static', filename='remote-controller/icon/air-conditioner.svg') }}" /></h3>
            <div class="button-group">
                <button id="audrey-on">에어컨 켜기</button>
                <button id="audrey-off">에어컨 끄기</button>
            </div>
            <div class="button-group">
                <button id="audrey-power-on">파워모드 켜기</button>
                <button id="audrey-power-off">파워모드 끄기</button>
            </div>

            <h3>Brice<img class="icon" alt="전등" src="{{ url_for('static', filename='remote-controller/icon/lamp.svg') }}" /></h3>
            <div class="button-group">
                <button id="brice-switch-on">모든 전등 켜기</button>
                <button id="brice-switch-off">모든 전등 끄기</button>
            </div>
            <div class="button-group">
                <button id="brice-switch-on-1">방 전등 켜기</button>
                <button id="brice-switch-off-1">방 전등 끄기</button>
            </div>
            <div class="button-group">
                <button id="brice-switch-on-2">복도등 켜기</button>
                <button id="brice-switch-off-2">복도등 끄기</button>
            </div>

            <h3>Cathy<img class="icon awair" alt="어웨어" src="{{ url_for('static', filename='remote-controller/icon/awair.svg') }}" /></h3>
            <div id="cathy-loading">
                <div class="bounceball"></div>
                <div>
                    현재 공기질 데이터를<br> 불러오는 중입니다.
                </div>
            </div>
            <div id="cathy-data">
                <div class="data-head-wrapper">
                    <div class="data major">
                        <label for="total_score">종합 점수</label>
                        <div class="value" id="total_score"><span class="number">90</span><span class="unit">점</span></div>
                    </div>
                    <div id="legend">
                        <span class="color4">⬤</span>
                        <span class="color3">⬤</span>
                        <span class="color2">⬤</span>
                        <span class="color1">⬤</span>
                        <span class="color0">⬤</span>
                    </div>
                </div>
                <div class="data-body-wrapper">
                    <div class="data minor">
                        <label for="temperature">온도</label>
                        <div class="value" id="temperature"><span class="number">90</span><span class="unit">℃</span></div>
                    </div>
                    <div class="data minor">
                        <label for="humidity">습도</label>
                        <div class="value" id="humidity"><span class="number">90</span><span class="unit">%</span></div>
                    </div>
                    <div class="data minor">
                        <label for="voc">VOC</label>
                        <div class="value" id="voc"><span class="number">90</span><span class="unit">ppb</span></div>
                    </div>
                    <div class="data minor">
                        <label for="pm25">초미세먼지</label>
                        <div class="value" id="pm25"><span class="number">90</span><span class="unit">µm/m³</span></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="footnote">
            <figure>
                <img id="abc" src="{{ url_for('static', filename='abc-150x150.png') }}" alt="abc" />
                <figcaption id="abc_name" lang="en">Mr. Alexander Bonaparte Cust</figcaption>
            </figure>
            <blockquote id="abc_script">
                <div class="quote open">&ldquo;</div>
                흠..이건 좀 못생겼는데, 당분간은 어쩔 수가 없군요. 일단 쓰고 계시면 더 멋있는 녀석으로 준비해서 드리겠습니다.
                <div class="quote close">&rdquo;</div>
            </blockquote>
        </div>
        <div id="footer">
            The air conditioner icon made by <a href="https://www.freepik.com" title="Freepik" target="_blank" rel="noopener">Freepik</a>,<br>
            the lamp icon made by <a href="https://www.flaticon.com/authors/icongeek26" title="Icongeek26" target="_blank" rel="noopener">Icongeek26</a><br>
            from <a href="https://www.flaticon.com/" title="Flaticon" target="_blank" rel="noopener">www.flaticon.com</a><br>
            is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank" rel="noopener">CC 3.0 BY</a>
        </div>
        <script>
        function request(url, method, params) {
            return fetch(url, {
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                method: method,
                body: JSON.stringify(params)
            });
        }

        function getElement(id) {
            return document.getElementById(id);
        }

        getElement('audrey-on').onclick = function(e) {
            request('/abc/api/audrey', 'POST', {'on': true});
        }

        getElement('audrey-off').onclick = function(e) {
            request('/abc/api/audrey', 'POST', {'on': false});
        }

        getElement('audrey-power-on').onclick = function(e) {
            request('/abc/api/audrey/power', 'POST', {'on': true});
        }

        getElement('audrey-power-off').onclick = function(e) {
            request('/abc/api/audrey/power', 'POST', {'on': false});
        }

        getElement('brice-switch-on').onclick = function(e) {
            request('/abc/api/brice/switch/', 'POST', {'on': true});
        }

        getElement('brice-switch-off').onclick = function(e) {
            request('/abc/api/brice/switch/', 'POST', {'on': false});
        }

        getElement('brice-switch-on-1').onclick = function(e) {
            request('/abc/api/brice/switch/1', 'POST', {'on': true});
        }

        getElement('brice-switch-off-1').onclick = function(e) {
            request('/abc/api/brice/switch/1', 'POST', {'on': false});
        }

        getElement('brice-switch-on-2').onclick = function(e) {
            request('/abc/api/brice/switch/2', 'POST', {'on': true});
        }

        getElement('brice-switch-off-2').onclick = function(e) {
            request('/abc/api/brice/switch/2', 'POST', {'on': false});
        }
        function loadCathyData() {
            request('/abc/api/cathy/', 'GET').then(function(response) {
                return response.json();
            }).then(function(response) {
                score = response.data;
                console.log(score);
                setData('total_score', score.total_score);
                setData('temperature', score.temperature);
                setData('humidity', score.humidity);
                setData('voc', score.voc);
                setData('pm25', score.pm25);
                getElement('cathy-loading').style.display = 'none';
                getElement('cathy-data').style.display = 'inherit';
            });
        }

        function setData(id, data) {
            const element = getElement(id).querySelector('.number');
            element.innerHTML = data.score;
            setColorIndex(element, data.color);
            getElement(id).querySelector('.number').innerHTML = data.score;
        }

        function setColorIndex(ele, colorIndex) {
            removeColorIndex(ele);
            ele.className += " color" + colorIndex;
        }

        function removeColorIndex(ele) {
            var reg = new RegExp('(\\s|^)color\\d(\\s|$)');
            ele.className = ele.className.replace(reg, ' ');
        }

        setInterval(loadCathyData, 60 * 1000);
        loadCathyData();
        </script>
    </body>
</html>
